<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0/EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Enterprise">

	<resultMap id="EnterpriseResult" type="EnterpriseVO">
        <result property="epCode" column="EP_CODE" />
        <result property="epNm" column="EP_NM" />
        <result property="epMgmtNm" column="EP_MGMT_NM" />
        <result property="state" column="STATE" />
        <result property="rgstDay" column="RGST_DAY" />
	</resultMap>

	<insert id="insertEnterprise" parameterType="EnterpriseVO">
        INSERT INTO EP_MGMT (
            EP_CODE,
            EP_NM,
            EP_MGMT_NM,
            STATE,
            RGST_DAY,
            MODI_DT
        ) 
        VALUES (
            'EP'||lpad(EP_SEQ.nextval,4,0),
            #{epNm},
            #{epMgmtNm},
            #{state},
            SYSDATE,
            SYSTIMESTAMP
        )
	</insert>

    <select id="listEnterprise" resultMap="EnterpriseResult">
        SELECT
            EP_CODE ,
            EP_NM ,
            EP_MGMT_NM ,
            TO_CHAR(RGST_DAY,'YYYY-MM-DD HH24:MI:SS') AS  RGST_DAY 
        FROM EP_MGMT
        ORDER BY RGST_DAY DESC
    </select>

    <select id="getEnterpriseInfo"  parameterType="EnterpriseVO" resultMap="EnterpriseResult">
          SELECT
            EP_CODE,
            EP_NM,
            EP_MGMT_NM,
            STATE
        FROM EP_MGMT
        WHERE EP_CODE = #{epCode}
    </select>

    <update id="updateEnterpriseInfo" parameterType="EnterpriseVO">
        UPDATE EP_MGMT 
        SET 
            EP_CODE     = #{epCode},
            EP_NM       = #{epNm},
            EP_MGMT_NM  = #{epMgmtNm},
            STATE       = #{state},
            MODI_DT     = SYSTIMESTAMP
        WHERE EP_CODE 	= #{epCode}
    </update>

    <delete id="deleteEnterpriseInfo" parameterType="EnterpriseVO">
        DELETE 
        FROM EP_MGMT
        WHERE EP_CODE = #{epCode}
    </delete>

</mapper>